<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
<head>
  <meta charset="UTF-8">
  <title>Toggl to FreeAgent Timesheet</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <style>
    body {
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      min-height: 100vh;
    }
    footer {
      margin-top: auto;
    }
    .ribbon {
      position: absolute;
      top: 0;
      right: 0;

    }
  </style>
</head>
<body class="p-4">
  <main>
    <div class="container container-xxl">
    <div class="d-flex justify-content-between align-items-start mb-2">
      <h1 class="mb-3">Toggl to FreeAgent Timesheet</h1>
      <button id="themeToggle" class="btn btn-sm btn-secondary">Toggle theme</button>
    </div>
    <p>
      <button class="btn btn-link p-0" data-bs-toggle="collapse" data-bs-target="#usage" aria-expanded="false" aria-controls="usage">How do I use this?</button>
    </p>
    <div class="collapse" id="usage">
      <div class="card card-body mb-3">
        <p>This tool provides an interface that displays your Toggl export in a layout matching FreeAgent's weekly timesheet so you can quickly manually input your hours.</p>
        <ol>
          <li>Log in to Toggl and open <strong>Reports &gt; Detailed</strong>.</li>
          <li>Select the date range and any filters you require.</li>
          <li>Ensure that the following columns are enabled: <strong>Description, Duration, Member, Project, Start date, Weekday</strong>.</li>
          <li>Click <strong>Export &gt; CSV</strong> in the top-right corner.</li>
          <li>Upload the downloaded CSV using the field below.</li>
          <li>Select the week, user, project and task to view the hours worked.</li>
          <li>Log in to FreeAgent and open <strong>Work &gt; Time Tracking &gt; Add weekly timesheet</strong>.</li>
          <li>Input the data as shown in the Toggl to FreeAgent Timesheet tool.</li>
        </ol>
      </div>
    </div>

    <div class="mb-3">
      <label for="csvInput" class="form-label">CSV file from Toggl</label>
      <input type="file" class="form-control" id="csvInput" accept=".csv">
      <div id="csvError" class="form-text text-danger small d-none"></div>
      <div id="csvStatus" class="form-text text-success small d-none fw-bold"></div>
      <div id="csvHelp" class="form-text">The file never gets uploaded or stored anywhere - all processing is done locally in your browser.</div>
    </div>

    <div id="controls" style="display:none;">
      <div class="row row-cols-1 row-cols-md-5 g-3 mb-3">
        <div class="col">
          <label class="form-label">User</label>
          <select id="userSelect" class="form-select"></select>
        </div>
        <div class="col">
          <label class="form-label">Week Starting</label>
          <select id="weekSelect" class="form-select"></select>
        </div>
        <div class="col">
          <label class="form-label">Project</label>
          <select id="projectSelect" class="form-select"></select>
        </div>
        <div class="col">
          <label class="form-label">Task (Description)</label>
          <select id="taskSelect" class="form-select"></select>
        </div>
        <div class="col">
          <label class="form-label">Rounding</label>
          <select id="roundingSelect" class="form-select">
            <option>None</option>
            <option>Up to the hour</option>
            <option>Up to the half hour</option>
            <option>Closest hour</option>
            <option>Closest half hour</option>
          </select>
        </div>
      </div>
      
      <div class="container container-lg">
        <table class="table table-bordered table-striped">
          <thead>
            <tr>
              <th style="width: 50%" id="dayHeading">Day</th>
              <th style="width: 50%" id="hoursHeading">Hours Worked</th>
            </tr>
          </thead>
          <tbody id="timesheetBody">
            <!-- Populated via JS -->
          </tbody>
          <tfoot>
            <tr class="fw-bold">
              <td>Total</td>
              <td id="tableTotal"></td>
            </tr>
          </tfoot>
        </table>
        <p id="weekSummary" class="fw-bold mt-2"></p>
      </div>
    </div>
  </main>
  <footer class="container container-xxl text-center lh-lg">
    <a href="https://github.com/itsViney/toggl-to-freeagent"><img src="https://img.shields.io/badge/github-%23121011.svg?style=for-the-badge&logo=github&logoColor=white" alt="Github"></a><br />
    Thrown together by üßîüèª‚Äç‚ôÇÔ∏è <a href="https://www.itsviney.com">Viney</a> and ü§ñ <a href="https://openai.com/codex/">Codex</a>.
  </footer>
  <div class="ribbon d-none">
    <a href="#">Fork me on Github</a>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <script src="js/main.js"></script>
</body>
</html>
